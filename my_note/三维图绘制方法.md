# 三维图绘制方法

### 通过svisual得到一定数量的CSV

```scheme{.line-numbers}
#setdep @previous@

load_file ./MOS1_n@node|SC@_des.tdr -name  plot_n@node@_tdr
create_plot -dataset plot_n@node@_tdr -name plot_n@node@
select_plots {plot_n@node@}
set_field_prop -plot plot_n@node@ -geom plot_n@node@_tdr ElectricField -show_bands

if {@x1@ > @x0@} {
set xmaxval @x1@
set xminval @x0@
}
if {@x1@ < @x0@} {
set xmaxval @x0@
set xminval @x1@
}
if {@y1@ > @y0@} {
set ymaxval @y0@
set yminval @y1@
}
if {@y1@ < @y0@} {
set ymaxval @y0@
set yminval @y1@
}
set fx  [expr 1.0*($xmaxval-$xminval)/@number@]
for {set i 0} {$i < @number@} {incr i} {
set m [expr $i*$fx]
set k [expr $xminval+$m]
create_cutline -plot plot_n@node@ -type x -at $k  -name C1(plot_n@node@)_$i
create_plot -dataset C1(plot_n@node@)_$i -1d -name c1_tdr_$i
select_plots "{c1_tdr_$i}"
create_curve -plot c1_tdr_$i -dataset "{C1(plot_n@node@)_$i}" -axisX Y -axisY ElectricField -name 1121
export_curves {1121} -plot c1_tdr_$i -filename ./data/$k.csv -format csv -overwrite

remove_curves -plot c1_tdr_$i {1121}
select_plots {plot_n@node@}
remove_plots "{c1_tdr_$i}"
remove_datasets "{C1(plot_n@node@)_$i}"
puts "##############################"
puts "final $i"
}
remove_plots plot_n@node@
```

### 利用python对CSV进行处理

```scheme{.line-numbers}
import os
import pandas as pd

file_list = list()
# csv文件所在目录

files = os.listdir('C:/Users/lenovo/Desktop/test/data')
for file in files:
    df = pd.read_csv(file,error_bad_lines=False,header=None,skiprows=[0])
    df['filename'] = file # filename为新增的列名，可以根据需求自己设置encoding='utf-8',error_bad_lines=False
    file_list.append(df)

all_VA = pd.concat(file_list,axis=0,ignore_index=True)
all_VA.to_csv('all_VA.csv')

```


### 在origin中对数据处理

将工作表转换成矩阵，其中x，y轴为所选切面，z轴为所选切面的数据（ElectricField）。

![1666159584333](image/三维图绘制方法/1666159584333.png)

![1666160054196](image/三维图绘制方法/1666160054196.png)

![1666160074179](image/三维图绘制方法/1666160074179.png)![1666160089229](image/三维图绘制方法/1666160089229.png)
